<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>UOUS Player</title>
    <script src="https://unpkg.com/wavesurfer.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <style>
      body {
        background-color: #121212;
        font-family: 'Helvetica Neue', sans-serif;
        color: #fff;
      }
      .track-card:hover {
        background-color: #1e1e1e;
      }
      /* UPDATED play button styles - SoundCloud style round orange button */
      .play-btn {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        background-color: #ff5500;
        border: none;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        transition: background-color 0.3s ease;
      }
      .play-btn:hover {
        background-color: #ff7700;
      }
      .play-icon {
        width: 0; 
        height: 0; 
        border-style: solid;
        border-width: 10px 0 10px 16px;
        border-color: transparent transparent transparent white;
        margin-left: 3px;
      }
      .pause-icon {
        display: flex;
        justify-content: space-between;
        width: 14px;
        height: 16px;
      }
      .pause-icon div {
        background: white;
        width: 4px;
        height: 16px;
        border-radius: 1px;
      }
    </style>
  </head>
  <body class="min-h-screen p-6">
    <h1 class="text-3xl font-bold mb-6">UOUS Tracks</h1>
    <div id="track-list" class="space-y-6"></div>

    <script>
      const repoURL = "https://classicvinyl.github.io/audio-player";
      const jsonURL = `${repoURL}/files.json`; // auto-generated or manually maintained

      async function loadTracks() {
        const res = await fetch(jsonURL);
        const tracks = await res.json();

        const list = document.getElementById("track-list");

        tracks.forEach((track, i) => {
          const id = `waveform-${i}`;

          const container = document.createElement("div");
          container.className =
            "track-card p-4 rounded-lg border border-gray-700 shadow-md";

          container.innerHTML = `
            <div class="flex items-center justify-between">
              <!-- UPDATED: display title WITHOUT .mp3 extension -->
              <div class="text-xl font-semibold">${track.title.replace(/\.mp3$/i, '')}</div>
              <button class="play-btn" data-id="${id}" aria-label="Play/pause">
                <div class="play-icon"></div>
              </button>
            </div>
            <div id="${id}" class="mt-3"></div>
          `;

          list.appendChild(container);

          const wavesurfer = WaveSurfer.create({
            container: `#${id}`,
            waveColor: '#666',
            progressColor: '#ff5500',
            height: 60,
            barWidth: 2,
            responsive: true,
            normalize: true,
          });

          wavesurfer.load(`${repoURL}/${track.file}`);

          const btn = container.querySelector(".play-btn");

          btn.addEventListener("click", (e) => {
            if (wavesurfer.isPlaying()) {
              wavesurfer.pause();
              btn.innerHTML = `<div class="play-icon"></div>`;
            } else {
              wavesurfer.play();
              btn.innerHTML = `
                <div class="pause-icon">
                  <div></div><div></div>
                </div>`;
            }
          });
        });
      }

      loadTracks();
    </script>
  </body>
</html>
