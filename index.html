<script>
  const tracks = [
    {
      name: "Star Wars Theme",
      artist: "John Williams",
      url: "https://www2.cs.uic.edu/~i101/SoundFiles/StarWars3.wav"
    }
  ];

  const tracksContainer = document.getElementById("tracks");
  tracksContainer.innerHTML = "";

  const wavesurfers = [];

  tracks.forEach((track, index) => {
    // Create track container
    const trackEl = document.createElement("div");
    trackEl.classList.add("track");

    // Track info
    const infoEl = document.createElement("div");
    infoEl.classList.add("track-info");
    infoEl.innerHTML = `<strong>${track.name}</strong> â€” <em>${track.artist}</em>`;

    // Waveform container
    const waveformEl = document.createElement("div");
    waveformEl.classList.add("waveform");
    waveformEl.id = `waveform-${index}`;

    // Controls
    const controlsEl = document.createElement("div");
    controlsEl.classList.add("controls");

    const playBtn = document.createElement("button");
    playBtn.classList.add("btn");
    playBtn.textContent = "Play";

    controlsEl.appendChild(playBtn);

    trackEl.appendChild(infoEl);
    trackEl.appendChild(waveformEl);
    trackEl.appendChild(controlsEl);
    tracksContainer.appendChild(trackEl);

    // Create WaveSurfer instance
    const wavesurfer = WaveSurfer.create({
      container: `#waveform-${index}`,
      waveColor: "#888",
      progressColor: "#1DB954",
      cursorColor: "#fff",
      barWidth: 2,
      barRadius: 3,
      height: 80,
      responsive: true,
    });

    wavesurfer.load(track.url);

    // Play/pause toggle
    playBtn.addEventListener("click", () => {
      if (wavesurfer.isPlaying()) {
        wavesurfer.pause();
        playBtn.textContent = "Play";
      } else {
        // Pause all other players
        wavesurfers.forEach((ws, i) => {
          if (i !== index) {
            ws.pause();
            const btn = document.querySelector(`#waveform-${i}`).parentNode.querySelector(".btn");
            if (btn) btn.textContent = "Play";
          }
        });
        wavesurfer.play();
        playBtn.textContent = "Pause";
      }
    });

    wavesurfer.on("finish", () => {
      playBtn.textContent = "Play";
    });

    wavesurfers.push(wavesurfer);
  });
</script>
